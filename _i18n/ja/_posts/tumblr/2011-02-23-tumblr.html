---
layout: post
title: Tumblrをブログとして利用する-実践編-
date: '2011-02-23T18:45:00+09:00'
tags:
- javascript
- tumblr
- css
permalink: /post/3461724032
---
<p>以前書いた<a title="Tumblrをブログとして使うためにやるべき事 | Web scratch" href="http://efcl.info/2011/0116/res2211/" target="_blank">Tumblrをブログとして使うためにやるべき事 | Web scratch</a>の焼き直しと投稿手法などについて詳細を追加したものです。</p>
<p>目次<br/>   1. ブログ用サブtumblelogを作成<br/>   2. ドメインの設定<br/>   3. テーマの設定<br/>   4. アクセス解析、DISQUSの設定<br/>   5. ブログ内検索<br/>   6. 記事の投稿について(new)</p>
<p>(実践編とあるがそれ以外はありません)</p>
<ul><li>ブログ用サブtumblelogを作成</li>
</ul><p>メイン(アカウントID)のTumblelogはなぜか共同更新など省かれている機能があるため、「Dashboard」の右側にあるメニューで「+Create a new Tumblelog」からブログ用のサブTumblelogを作成するのがよいと思います。<br/>記事の投稿者名にはメインのIDが使用されるようなので、サブと言ってもメインと完全に切り離されたものではないことに注意しましょう。<br/>-<a title="【連載】『Tumblr』のおさらい (12) 複数人でTumblelogを共同更新してみる | ネット | マイコミジャーナル" href="http://journal.mycom.co.jp/series/tumblr/012/index.html" target="_blank">【連載】『Tumblr』のおさらい (12) 複数人でTumblelogを共同更新してみる | ネット | マイコミジャーナル</a></p>
<ul><li>独自ドメインの設定</li>
</ul><p>Tumblrはドメインを設定できるため、ドメインを持っているなら活用しましょう。<br/>ドメイン側の設定としてDNSレコードでTumblrのIPアドレスを振って、Customizeの「Info」 メニューの一番下にある 「Use a custom domain name」 にチェックして取得したドメインを設定することで反映できます。<br/><a title="Custom Domain Test | Tumblr" href="http://www.tumblr.com/check_domain" target="_blank">http://www.tumblr.com/check_domain</a>というチェックツールも用意されているので正しく設定されているかを確認しましょう。<br/>-<a title="独自ドメインで Tumblr を使う | WWW WATCH" href="http://hyper-text.org/archives/2009/04/tumblr_custom_domain.shtml" target="_blank">独自ドメインで Tumblr を使う | WWW WATCH</a></p>
<ul><li>テーマの設定</li>
</ul><p>Tumblrのテーマは「Theme」タブからテンプレートか自分でカスタマイズすることができます。そこそこ細かくいじれるため、既存のテーマや<a title="Creating a custom HTML theme | Tumblr" href="http://www.tumblr.com/docs/en/custom_themes" target="_blank">Creating a custom HTML theme | Tumblr</a>を参考にしてテーマを作成するのが手っ取り早いです。どこまでカスタマイズするかは自由ですが、Autopagerizeが動かないと鈍器で殴られるので下を参考に対応しましょう。<a title="Autopagerizeが動かないtumblrなんて&amp; - otsune tumblr まとめサイト 画像保管庫Q" href="http://otsune.tumblr.com/post/334387549/autopagerize-tumblr" target="_blank"><br/>-Autopagerizeが動かないtumblrなんて… – otsune tumblr まとめサイト 画像保管庫Q</a></p>
<p>またテーマに使用する画像やJavaScriptやCSSなどの静的なファイルは<a title="Upload a static file" href="http://www.tumblr.com/themes/upload_static_file" target="_blank">Upload a static file</a>にアップロードして利用することができます。</p>
<p>当サイトでは最近の投稿やタグクラウドを表示していますが、これは<a title="Tumblrでタグリスト/新規投稿リストを出力してみる | Mach3.laBlog" href="http://blog.mach3.jp/2010/10/js-tumblrposts.html" target="_blank">Tumblrでタグリスト/新規投稿リストを出力してみる | Mach3.laBlog</a>を利用してJavaScriptでAPIをたたいて毎回表示させているだけです。<br/>-<a title="gist: 838726 - GitHub" href="https://gist.github.com/838726" target="_blank">gist: 838726 - GitHub</a></p>
<ul><li>アクセス解析、DISQUSの設定</li>
</ul><p>ブログとして使いたい場合<strong>アクセス解析</strong>などをしたい場合があると思います。<br/>Tumblrでは<a title="Google Analytics | 公式ウェブサイト" href="http://www.google.com/intl/ja/analytics/" target="_blank">Google Analytics</a>に標準で対応しているテーマが多いため、「Apperence」タブのGoogle Analytics UA CodeにUA-xxxと入れるだけ使用できることがほとんどです。<br/>しかし、多くの場合は古い<a title="Google Analytics | 公式ウェブサイト" href="http://www.google.com/intl/ja/analytics/" target="_blank">Google Analytics</a>のコードであるため、<a title="非同期トラッキング コード" href="http://www.google.com/support/analytics/bin/answer.py?answer=174894" target="_blank">非同期トラッキング コード</a>に変更するといいかと思います。<br/>変 更のために、まず元々ある{block:IfGoogleAnalyticsUACode}～ {/block:IfGoogleAnalyticsUACode}を削除してから、次のようなコードを&lt;/head&gt;前に書いておくことで 非同期のトラッキングコードを利用できます。</p>
<pre><span class="synIdentifier">{</span>block:IfGoogleAnalyticsUACode<span class="synIdentifier">}</span><br/>&lt;script type=<span class="synConstant">"text/javascript"</span>&gt;<br/><span class="synIdentifier">var</span> _gaq = _gaq || <span class="synIdentifier">[]</span>;<br/>  _gaq.push(<span class="synIdentifier">[</span><span class="synConstant">'_setAccount'</span>, <span class="synConstant">''</span><span class="synIdentifier">]</span>);<br/>  _gaq.push(<span class="synIdentifier">[</span><span class="synConstant">'_trackPageview'</span><span class="synIdentifier">]</span>);<br/>  (<span class="synIdentifier">function</span>() <span class="synIdentifier">{</span><br/><span class="synIdentifier">var</span> ga = <span class="synStatement">document</span>.createElement(<span class="synConstant">'script'</span>); ga.type = <span class="synConstant">'text/javascript'</span>; ga.async = <span class="synConstant">true</span>;<br/>    ga.src = (<span class="synConstant">'https:'</span> == <span class="synStatement">document</span>.<span class="synStatement">location</span>.protocol ? <span class="synConstant">'https://ssl'</span> : <span class="synConstant">'http://www'</span>) + <span class="synConstant">'.google-analytics.com/ga.js'</span>;<br/><span class="synIdentifier">var</span> s = <span class="synStatement">document</span>.getElementsByTagName(<span class="synConstant">'script'</span>)<span class="synIdentifier">[</span>0<span class="synIdentifier">]</span>; s.parentNode.insertBefore(ga, s);<br/><span class="synIdentifier">}</span>)();<br/>&lt;/script&gt;<br/><span class="synIdentifier">{</span>/block:IfGoogleAnalyticsUACode<span class="synIdentifier">}</span><br/></pre>
<p>Google Analyticsの非同期コードを入れたついでにGoogleウェブマスター  ツールでsitemap.xmlを登録しましょう。使ってるTumblrのURLを追加して、所有者の確認で”Google Analytics  アカウントにリンク”を選べば簡単に登録できます。(非同期コードを仕込んでいる必要がある)<br/>サイト設定→サイトマップから”サイトマップを送信”でサイトマップのURLを追加します。<br/>サイトマップのURLは http://&lt;ドメイン&gt;/sitemap.xml に自動的に生成されていると思うのでそれを指定します。</p>
<p>SEOを気にする人は以下を参考にMetaタグなどの設定をするとよいかもしれません。</p>
<ol><li><a title="4 Tumblr SEO Tips - Jauder Ho - tumblr, seo, sitemap, - links and things" href="http://tumblelog.jauderho.com/post/122434303/4-tumblr-seo-tips" target="_blank">4 Tumblr SEO Tips – Jauder Ho – tumblr, seo, sitemap, – links and things</a></li>
<li><a title="tumblr. note4 tumblrの４つのSEO対策 - 花あそびエコブログ" href="http://hana-asobi.tumblr.com/post/444383843/tumblr-note4-tumblr-4-seo" target="_blank">tumblr. note4 tumblrの４つのSEO対策 – 花あそびエコブログ</a> (上の訳)</li>
<li><a title="tumblrがgoogle sitemaps対応になってた « ku" href="http://ido.nu/kuma/2008/01/29/now-tumblr-supports-google-sitemaps/" target="_blank">tumblrがgoogle sitemaps対応になってた «&#160;ku</a></li>
<li><a title="SEO on Tumblr Blog | SocialBlogr" href="http://www.socialblogr.com/2010/03/seo-on-tumblr-blog.html" target="_blank">SEO on Tumblr Blog | SocialBlogr</a></li>
</ol><p><strong>DISQUSについて</strong></p>
<p>Tumblrでreblogやlikeの表示やコメント欄の作成には<a title="DISQUS" href="http://disqus.com/" target="_blank">DISQUS</a>を利用すると簡単に設定できます。<br/>こちらもアクセス解析と同じように「Apperence」タブの<a target="_blank" href="http://disqus.com/">Disqus</a> ShortnameにDISQUSのIDを入れることで利用できます。(テーマにDISQUSの表示についての記述が必要となります)</p>
<ul><li>ブログ内検索</li>
</ul><p><a title="Tumblrで日本語検索をするいくつかの方法 - conflict error" href="http://webkit.seesaa.net/article/129746010.html" target="_blank">Tumblrで日本語検索をするいくつかの方法 – conflict error</a>からわかるようにTumblrの検索は日本語が通らない(タグでは通る)ので、何かしらの代用手段が必要になると思います。</p>
<p>これを解決するためJSer.infoでは<a title="Trunk.ly" href="http://trunk.ly/" target="_blank">Trunk.ly</a>というサービスを利用します。<a title="Trunk.ly" href="http://trunk.ly/" target="_blank">Trunk.ly</a>は   TwitterやRSSからリンクを取り込んで検索する事ができるサービスです。検索対象に自分のTumblrのRSSを取り込めば、取り込んだ時点から の内容は検索が可能になります。日本語も問題なく検索でき、記事中に出てきたリンク先も解析対象にするため検索の取りこぼしは少ないです。<br/><a title="Trunk.ly" href="http://trunk.ly/" target="_blank">Trunk.ly</a>サイト内ならインクリメンタルサーチもできるため、検索機能自体はかなり優秀な印象です。<br/>-<a title="All links shared by JSer | Trunk.ly: Never forget a link" href="http://trunk.ly/jser/" target="_blank">All links shared by JSer | Trunk.ly: Never forget a link(このサイトのアカウント)</a></p>
<p>サイト内から検索結果にジャンプできるようにformのactrionにtrunk.lyを指定すると検索窓の代わりに使えたりします。</p>
<pre><span class="synIdentifier">&lt;</span><span class="synStatement">form</span><span class="synIdentifier"> </span><span class="synType">action</span><span class="synIdentifier">=</span><span class="synConstant">"http://trunk.ly/jser/"</span><span class="synIdentifier"> </span><span class="synType">method</span><span class="synIdentifier">=</span><span class="synConstant">"get"</span><span class="synIdentifier">&gt;</span><br/><span class="synIdentifier">&lt;</span><span class="synStatement">input</span><span class="synIdentifier"> </span><span class="synType">type</span><span class="synIdentifier">=</span><span class="synConstant">"text"</span><span class="synIdentifier"> </span><span class="synType">id</span><span class="synIdentifier">=</span><span class="synConstant">"search"</span><span class="synIdentifier"> </span><span class="synType">name</span><span class="synIdentifier">=</span><span class="synConstant">"q"</span><span class="synIdentifier"> </span><span class="synType">value</span><span class="synIdentifier">=</span><span class="synConstant">"Lost something in the post?*"</span><span class="synIdentifier"> /&gt;</span><br/><span class="synIdentifier">&lt;/</span><span class="synStatement">form</span><span class="synIdentifier">&gt;</span><br/></pre>
<p>当サイトの右側にある検索窓はそれの実例です。</p>
<ul><li><strong>記事の投稿について</strong></li>
</ul><p>ここからはJSer.infoではどのように記事を投稿しているかの紹介というか例みたいなものです。<br/>まずは投稿の仕方ですが、基本的にはText Postから投稿を行います。(他のは妙に制限があったりするため)<br/>またTumblrでは簡易なリッチエディタを使用して記事を書くことができますが、リッチエディタが妙に縦に短いためuserContent.cssを利用して少し拡張しています。</p>
<pre><span class="synComment">/* Tumblr */<br/>@-moz-document url-prefix("http://www.tumblr.com/edit/"),<br/>               url-prefix("http://www.tumblr.com/tumblelog/"){<br/>    #post_two_ifr{<br/>        height:500px!important;<br/>    }<br/>}</span></pre>
<p>userContent.cssで上記のようにheightを少し変更して使用しています。(Wordpressみたいにリサイズ機能つければいいのに)</p>
<p>また記事を閲覧中に直ぐに編集ページにいけるように、<a title="Tumblr - Edit link" href="https://gist.github.com/838690" target="_blank">Tumblr - Edit link</a>というGreasemonkeyを使用しています。(@includeは各自のドメインに直してください)<br/>インストールすると各記事の左上にEditのリンクが表示されるようになります。<br/><img src="http://media.tumblr.com/tumblr_lh0utsckJl1qz6g63.png"/></p>
<p>このサイトのようにプログラミングを扱う場合はコードを記事中に書き込みたい場合もあると思います。<br/><a title="Gist - GitHub" href="https://gist.github.com/" target="_blank">Gist - GitHub</a>のような埋め込みコードを利用する方法もありますが、静的にシンタックスハイライトを適応したコードを表示するために<a title="VimColor - source code highlight" href="http://vimcolor.spiritloose.net/" target="_blank">VimColor - source code highlight</a>を利用してコードをハイライト用のHTMLタグを生成して利用しています。<br/>毎回サイトに行って生成するのは面倒なのでクリップボードの内容から生成してくれるように<a title="Clipboard_to_VimColorHTML.ng" href="https://github.com/azu/NILScript/tree/master/utilityTools/JavaScript" target="_blank">Clipboard_to_VimColorHTML.ng</a>という<a href="http://lukewarm.s151.xrea.com/nilscript.html" target="_blank">NILScript</a>を書いて利用しています。クリップボードにハイライトしたいコードをコピーして実行するとシンタックスハイライト用のHTMLがクリップボードにコピーされます。(JavaScriptオンリーです)<br/>シンタックスハイライト用のHTMLとなったコードには以下のようなCSSを適して表示しています。</p>
<pre>pre{<br/>  font-family: monospace;<br/>  background-color: #FFEEAA;<br/>  border:1px solid #000000;<br/>  font-size:90%;<br/>  overflow:auto;<br/>  padding:5px;<br/>  width:97%;<br/>}<br/>span.synSpecial{<br/>  color: blue;<br/>}<br/>span.synType{<br/>  color: blue;<br/>}<br/>span.synComment{<br/>  color: green;<br/>}<br/>span.synPreProc{<br/>  color: blue;<br/>}<br/>span.synIdentifier{<br/>  color: teal;<br/>}<br/>span.synConstant{<br/>  color: #c00000;<br/>}<br/>span.synStatement{<br/>  color: blue;<br/>}</pre>
<p>という感じのCSSを適応しています。</p>
<p>最後にJSer.infoの記事の手順としては情報集めが一番大事なため、記事を書くための労力を最小限にしてTomblooのクロスポストを利用して下書きを情報集めと同時に書いています。<br/>以下のようなローカルにHTMLを生成するTomblooパッチを書いて利用しています。<br/>-<a title="gist: 781466 - Tomblooのデータフォルダに年月フォルダ内htmlで記録するパッチ- GitHub" href="https://gist.github.com/781466" target="_blank">gist: 781466 - Tomblooのデータフォルダに年月フォルダ内htmlで記録するパッチ- GitHub</a></p>
<p>個人的には<a title="WikiHub" href="http://wikihub.org/" target="_blank">WikiHub</a>のようなところと連携できるように書き直した方がもっといい感じになる気がしています。Tomblooパッチの方に話を戻しますが、紹介リンクの形式は</p>
<blockquote>
<p><strong>JSer.info</strong><br/><a href="http://jser.info/" target="_blank">http://jser.info/</a></p>
</blockquote>
<p>のようにblockquoteを使用しています。これはTumblrでreblogされるため常に自サイトのCSSが適されるわけではないことを想定しているからです。TumblrのダッシュボードやRSSリーダーなどではblockquoteはだいたい同じようなスタイルになっているので比較的表示が安定していることなどからこういう書き方になっています。</p>
<p>以上でTumblrをブログを使う実践については終わりですが、Tumblrはちょっと不安定なことがあったりしますが、あまり問題なく使えるのでブログの選択肢としては結構ありだと思います。<br/>この手のサービスを使う場合には<a title="Posterous" href="https://posterous.com/" target="_blank">Posterous</a>が競合として挙げられることも多いですが、どちらもいいところはあるので自分に合ったものを使うのが一番いいと思います。</p>
