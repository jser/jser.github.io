---
title: "2025-05-07のJS: koa v3.0.0、Node.js 24とNode.js 18 EOL、`//# allFunctionsCalledOnLoad`"
author: "azu"
layout: post
date: 2025-05-07T00:31:48.346Z
category: JSer
tags:
- nodejs
- React
- esbuild
- Firefox
- polyfill

---

JSer.info #734 - Koa v3.0.0がリリースされました。

- [Release v3.0.0 · koajs/koa](https://github.com/koajs/koa/releases/tag/v3.0.0)
- [koa/docs/migration-v2-to-v3.md at master · koajs/koa](https://github.com/koajs/koa/blob/master/docs/migration-v2-to-v3.md)

Node.js 18未満のサポート終了、Generatorを使ったMiddlewareのサポートを終了など破壊的な変更が含まれています。新機能として、`app.currentContext`でAsyncLocalStorageを使用した現在のコンテキスト取得をサポート、`Blob`/`ReadableStream`/`Response`のサポート、カスタムストリームのサポートなどが追加されています。

----

Node.jsのv24がリリースされました。

- [Node.js — Node v24.0.0 (Current)](https://nodejs.org/en/blog/release/v24.0.0)

Node.js 24では、V8 13.6へアップデート、npm 11の同梱、AsyncLocalStorageのAsyncContextFrameのデフォルト化、`URLPattern`のグローバル追加などの変更が含まれています。また、パーミッションモデルが`--permission`フラグで利用できるようになりました。

また、Node.js 18は2025年4月30日でEOL(End Of Support)となりました。

- [Node.js — Node.js Releases](https://nodejs.org/en/about/previous-releases)

----

V8エンジンに新しいコンパイルヒントの仕組みが実装されています。

- [Giving V8 a Heads-Up: Faster JavaScript Startup with Explicit Compile Hints · V8](https://v8.dev/blog/explicit-compile-hints)

`//# allFunctionsCalledOnLoad`というコメントによって、JavaScriptファイルのeager compilationを指定できる仕組みが実装されています。これにより、ファイル内の関数のコンパイルタイミングを制御でき、起動時のパフォーマンス最適化が可能になります。
一方で、なんでもコンパイルすると時間とメモリを消費してしまう問題があることについても触れられています。

- [WICG/explicit-javascript-compile-hints-file-based: This proposal introduces a new magic comment that signals to browsers that the functions in a JavaScript file are likely to be needed by the website. Spec draft: https://wicg.github.io/explicit-javascript-compile-hints-file-based/](https://github.com/WICG/explicit-javascript-compile-hints-file-based)

----

{% include inline-support.html %}

----

<h1 class="site-genre">ヘッドライン</h1>

----

## react-router/CHANGELOG.md at main · remix-run/react-router
[github.com/remix-run/react-router/blob/main/CHANGELOG.md#v752](https://github.com/remix-run/react-router/blob/main/CHANGELOG.md#v752 "react-router/CHANGELOG.md at main · remix-run/react-router")
<p class="jser-tags jser-tag-icon"><span class="jser-tag">React</span> <span class="jser-tag">library</span> <span class="jser-tag">ReleaseNote</span></p>

React Router v7.5.2リリース。
`X-React-Router-Prerender-Data`ヘッダーと`X--React-Router-SPA-Mode`ヘッダーに関する脆弱性を修正するセキュリティ修正

- [URL manipulation via Host / X-Forwarded-Host headers · Advisory · remix-run/react-router](https://github.com/remix-run/react-router/security/advisories/GHSA-4q56-crqp-v477 "URL manipulation via Host / X-Forwarded-Host headers · Advisory · remix-run/react-router")
- [React Router and the Remix’ed path - zhero\_web\_security](https://zhero-web-sec.github.io/research-and-things/react-router-and-the-remixed-path "React Router and the Remix’ed path - zhero\_web\_security")

----

## Release v0.25.3 · evanw/esbuild
[github.com/evanw/esbuild/releases/tag/v0.25.3](https://github.com/evanw/esbuild/releases/tag/v0.25.3 "Release v0.25.3 · evanw/esbuild")
<p class="jser-tags jser-tag-icon"><span class="jser-tag">esbuild</span> <span class="jser-tag">ReleaseNote</span></p>

esbuild v0.25.3リリース。
`--serve=`オプションでカスタムホストの指定を許可するように、CSS Nestingの制限を追加など


----

## Firefox 138.0, See All New Features, Updates and Fixes
[www.mozilla.org/en-US/firefox/138.0/releasenotes/](https://www.mozilla.org/en-US/firefox/138.0/releasenotes/ "Firefox 138.0, See All New Features, Updates and Fixes")
<p class="jser-tags jser-tag-icon"><span class="jser-tag">Firefox</span> <span class="jser-tag">ReleaseNote</span></p>

Firefox 138リリース。
`importmap`の`integrity`をサポート、`Error.captureStackTrace()`をサポート、ES Proposal Stage 3の`Error.isError()`をサポート。
Import Attributesを使ったJSONのimportをサポート、`Clear-Site-Data`で`cache`ディレクティブをサポート。
FedCM APIのLogin Status APIをサポート、Web Audio APIのMessage Portをサポート。
フラグ付きでMutationEventの削除、HTML Sanitizer APIのサポートなど

- [Firefox 138 for developers - Mozilla | MDN](https://developer.mozilla.org/en-US/docs/Mozilla/Firefox/Releases/138 "Firefox 138 for developers - Mozilla | MDN")

----

## Release 3.42.0 - 2025.04.30 · zloirock/core-js
[github.com/zloirock/core-js/releases/tag/v3.42.0](https://github.com/zloirock/core-js/releases/tag/v3.42.0 "Release 3.42.0 - 2025.04.30 · zloirock/core-js")
<p class="jser-tags jser-tag-icon"><span class="jser-tag">JavaScript</span> <span class="jser-tag">polyfill</span> <span class="jser-tag">ReleaseNote</span></p>

core-js v3.42.0リリース。
Map upsert proposalの更新、Iterator HelpersをES2025の仕様に合わせた変更など


----

## Deno 2.3: Improved deno compile, local npm packages, and more
[deno.com/blog/v2.3](https://deno.com/blog/v2.3 "Deno 2.3: Improved deno compile, local npm packages, and more")
<p class="jser-tags jser-tag-icon"><span class="jser-tag">deno</span> <span class="jser-tag">ReleaseNote</span></p>

Deno v2.3リリース。
`deno compile`でFFIとNode.js Native Addonのサポート、ローカルのnpmパッケージを参照できるように、`deno fmt`のオプションを追加。
Windowsの`deno`バイナリにコード署名をするように変更など


----

## ESLint v9.26.0 released - ESLint - Pluggable JavaScript Linter
[eslint.org/blog/2025/05/eslint-v9.26.0-released/](https://eslint.org/blog/2025/05/eslint-v9.26.0-released/ "ESLint v9.26.0 released - ESLint - Pluggable JavaScript Linter")
<p class="jser-tags jser-tag-icon"><span class="jser-tag">ESLint</span> <span class="jser-tag">ReleaseNote</span></p>

ESLint v9.26.0リリース。
`eslint --mcp`でMCPサーバとして起動できるように、`no-unused-expressions`ルールに`ignoreDirectives`オプションを追加など


----

## Electron 36.0.0 | Electron
[www.electronjs.org/blog/electron-36-0](https://www.electronjs.org/blog/electron-36-0 "Electron 36.0.0 | Electron")
<p class="jser-tags jser-tag-icon"><span class="jser-tag">Electron</span> <span class="jser-tag">ReleaseNote</span></p>

Electron 36.0.0リリース。  
Chromium 136、V8 13.6、Node 22.14.0にアップグレード。  
macOSのWriting ToolsやAutofill、Servicesメニューをサポートする新しい`menu.popup`オプションを追加。  
GTK 4がGNOMEでのデフォルトに変更。`NativeImage.getBitmap()`が非推奨に、`session.loadExtension`などが非推奨となり`Extensions`オブジェクトに移動された。


----

## Release v3.0.0 · koajs/koa
[github.com/koajs/koa/releases/tag/v3.0.0](https://github.com/koajs/koa/releases/tag/v3.0.0 "Release v3.0.0 · koajs/koa")
<p class="jser-tags jser-tag-icon"><span class="jser-tag">nodejs</span> <span class="jser-tag">ReleaseNote</span></p>

Koa v3.0.0リリース。
Node.js 18未満のサポート終了、Generatorを使ったMiddlewaのサポートを終了、`res.redirect('back')`を削除し`ctx.back()`を追加。
`app.currentContext`でAsyncLocalStorageを使用した現在のコンテキスト取得をサポート。`Blob`/`ReadableStream`/`Response`のサポート、カスタムストリームのサポートなど

- [koa/docs/migration-v2-to-v3.md at master · koajs/koa](https://github.com/koajs/koa/blob/master/docs/migration-v2-to-v3.md "koa/docs/migration-v2-to-v3.md at master · koajs/koa")

----

## Node.js — Node.js Releases
[nodejs.org/en/about/previous-releases](https://nodejs.org/en/about/previous-releases "Node.js — Node.js Releases")
<p class="jser-tags jser-tag-icon"><span class="jser-tag">nodejs</span> <span class="jser-tag">news</span></p>

Node.js 18は2025年4月30日でEOL(End Of Support)となった。


----

## Release 21.0.0 · nrwl/nx
[github.com/nrwl/nx/releases/tag/21.0.0](https://github.com/nrwl/nx/releases/tag/21.0.0 "Release 21.0.0 · nrwl/nx")
<p class="jser-tags jser-tag-icon"><span class="jser-tag">JavaScript</span> <span class="jser-tag">Tools</span> <span class="jser-tag">ReleaseNote</span></p>

Nx 21.0.0リリース。
Node.js 20.19.0以上が必要となり、`outputStyle=compact`の削除、`readWorkspaceConfig`の廃止などの破壊的変更を含む。
continuous taskの追加、タスク用のTerminal UI機能の追加、GitLabリリースのサポートなど

- [RFC: Continuous Tasks · nrwl/nx · Discussion #29025](https://github.com/nrwl/nx/discussions/29025 "RFC: Continuous Tasks · nrwl/nx · Discussion #29025")

----

## Release v0.25.4 · evanw/esbuild
[github.com/evanw/esbuild/releases/tag/v0.25.4](https://github.com/evanw/esbuild/releases/tag/v0.25.4 "Release v0.25.4 · evanw/esbuild")
<p class="jser-tags jser-tag-icon"><span class="jser-tag">esbuild</span> <span class="jser-tag">ReleaseNote</span></p>

esbuild v0.25.4リリース。
開発サーバーに`cors`オプションで`Access-Control-Allow-Origin`ヘッダを設定できるように。


----

## Node.js — Node v24.0.0 (Current)
[nodejs.org/en/blog/release/v24.0.0](https://nodejs.org/en/blog/release/v24.0.0 "Node.js — Node v24.0.0 (Current)")
<p class="jser-tags jser-tag-icon"><span class="jser-tag">nodejs</span> <span class="jser-tag">ReleaseNote</span></p>

Node.js v24.0.0リリース。
V8 13.6へアップデート、npm 11を同梱、AsyncLocalStorageがAsyncContextFrameをデフォルトで使用するように。
`URLPattern`をグローバルに追加、パーミッションモデルが`--permission`フラグで利用できるように、テストランナーの改善、Undici 7を同梱。
`url.parse()`を非推奨に変更など。
2025年10月にLTSとなる予定。

- [What’s New with Node.js 24 | OpenJS Foundation](https://openjsf.org/blog/nodejs-24-released "What’s New with Node.js 24 | OpenJS Foundation")

----
<h1 class="site-genre">アーティクル</h1>

----

## フロントエンド API コール時のエラーハンドリングを軽く整理（Fetch API・typescript-fetch・TanStack Query） - カミナシ エンジニアブログ
[kaminashi-developer.hatenablog.jp/entry/2025/04/30/080000](https://kaminashi-developer.hatenablog.jp/entry/2025/04/30/080000 "フロントエンド API コール時のエラーハンドリングを軽く整理（Fetch API・typescript-fetch・TanStack Query） - カミナシ エンジニアブログ")
<p class="jser-tags jser-tag-icon"><span class="jser-tag">Fetch</span> <span class="jser-tag">TypeScript</span> <span class="jser-tag">JavaScript</span> <span class="jser-tag">article</span> <span class="jser-tag">HTTP</span></p>

Fetch API/Open APIの`typescript-fetch`、TanStack QueryのFetchの例外処理について


----

## Giving V8 a Heads-Up: Faster JavaScript Startup with Explicit Compile Hints · V8
[v8.dev/blog/explicit-compile-hints](https://v8.dev/blog/explicit-compile-hints "Giving V8 a Heads-Up: Faster JavaScript Startup with Explicit Compile Hints · V8")
<p class="jser-tags jser-tag-icon"><span class="jser-tag">JavaScript</span> <span class="jser-tag">V8</span> <span class="jser-tag">article</span></p>

`//# allFunctionsCalledOnLoad` のコメントで、JavaScriptファイルをeager compilationをする仕組みをV8に実装している話。
JavaScriptは関数をコンパイルするにはファイルをパースをする必要があるため、コンパイルが必要かを判断するにも時間がかかってしまう。そのため、ファイルの先頭のコメントでコンパイルするべきかを判断できるようにするための仕組み


----
<h1 class="site-genre">ソフトウェア、ツール、ライブラリ関係</h1>

----

## Intent UI
[intentui.com/](https://intentui.com/ "Intent UI")
<p class="jser-tags jser-tag-icon"><span class="jser-tag">React</span> <span class="jser-tag">UI</span> <span class="jser-tag">library</span></p>

React Aria Componentsベースのshadcnライクなコピーペースト可能なコンポーネントライブラリ


----

## zumerlab/snapdom: snapDOM captures DOM nodes as images with exceptional speed and accuracy.
[github.com/zumerlab/snapdom](https://github.com/zumerlab/snapdom "zumerlab/snapdom: snapDOM captures DOM nodes as images with exceptional speed and accuracy.")
<p class="jser-tags jser-tag-icon"><span class="jser-tag">JavaScript</span> <span class="jser-tag">SVG</span> <span class="jser-tag">Image</span> <span class="jser-tag">library</span></p>

SVGの`<foreignObject>`を使いDOM要素を画像にするライブラリ。
Shadow DOM、疑似要素、背景画像、フォントの埋め込みやdata属性での除外などに対応している

- [bubkoo/html-to-image: ✂️ Generates an image from a DOM node using HTML5 canvas and SVG.](https://github.com/bubkoo/html-to-image "bubkoo/html-to-image: ✂️ Generates an image from a DOM node using HTML5 canvas and SVG.")

----

## pulsar-edit/pulsar: A Community-led Hyper-Hackable Text Editor
[github.com/pulsar-edit/pulsar](https://github.com/pulsar-edit/pulsar "pulsar-edit/pulsar: A Community-led Hyper-Hackable Text Editor")
<p class="jser-tags jser-tag-icon"><span class="jser-tag">atom</span> <span class="jser-tag">editor</span> <span class="jser-tag">JavaScript</span></p>

Atom EditorをForkしたエディタ。
Atom向けに作られたパッケージも動くようにしている


----
